{"version":3,"sources":["usertask.js"],"names":["con","require","SignIn","req","res","console","log","body","username","password","query","error","result","length","session","userid","id","email","redirect","SignUp","insertId","SignOut","destroy","err","module","exports"],"mappings":"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","sourcesContent":["const con = require('../db/dbconnect')\n\n//ログイン\nconst SignIn = (req,res) =>{\n    console.log(req.body)\n    const username = req.body.username;\n    const password = req.body.password;\n    con.query(\n        'SELECT * FROM USERS WHERE username=? AND password=?;'\n        ,[username,password],\n        (error,result)=>{\n            if(error) throw error;\n            console.log(result[0])\n            if(result.length){\n                req.session.userid= result[0].id;\n                console.log('ログイン成功ユーザーID： '+req.session.userid);\n                req.session.username = result[[0]].username;\n                req.session.email = result[0].email;\n                console.log(req.session.username)\n                // res.render('userpage.ejs',{username: result[0].username});\n                res.redirect(`/api/v1/userpage`);\n            }\n        }\n    )\n}\n\n//会員登録\nconst SignUp = (req,res) =>{\n    \n    const username = req.body.username;\n    const email = req.body.email;\n    const password = req.body.password;\n    // console.log(username,email,password)\n    con.query(\n        'INSERT INTO USERS (username,email,password) value(?,?,?);'\n        ,[username,email,password],\n        (error,result)=>{\n            console.log(result.insertId)\n            req.session.userid = result.insertId;\n            req.session.username = username\n            req.session.email = email;\n            console.log('会員登録されたユーザID：'+result.insertId)\n            if(error) throw error;\n            res.redirect(`/api/v1/userpage`)\n        }\n    )\n}\n\nconst SignOut = (req,res)=>{\n    console.log(req.session.userid)\n    req.session.destroy((err)=>{\n        if(err) throw err\n    });\n    \n    console.log('ログアウト完了')\n    res.redirect('/api/v1/');\n}\n\nmodule.exports = {SignIn,SignUp,SignOut}"],"file":"usertask.dev.js"}