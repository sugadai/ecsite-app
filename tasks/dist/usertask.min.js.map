{"version":3,"sources":["usertask.js"],"names":["con","require","SignIn","req","res","console","log","body","username","password","query","error","result","length","session","userid","id","email","redirect","insertId","SignOut","destroy","err","exports","module","SignUp"],"mappings":"aAAA,IAAMA,IAAMC,QAAQ,mBAGdC,OAAS,SAACC,EAAIC,GAChBC,QAAQC,IAAIH,EAAII,MADdL,IAAMM,EAAGL,EAATD,KAAUC,SACJG,EAAQC,EAAhBA,KAAAE,SACAT,IAAMQ,MACAC,uDACFC,CAAAA,EACAD,GAGOE,SAAAA,EAAOC,GACFN,GAARK,EAAkB,MAAlBA,EAAAN,QAAQC,IAAIM,EAAO,IACTC,EAAVA,SACQC,EAAQC,QAAQH,OAAAA,EAApB,GAAAI,GACQV,QAAIA,IAAA,iBAAqBQ,EAAQC,QAAzCA,QACID,EAAQN,QAAZA,SAA6BI,EAAMJ,CAAAA,IAAnCA,SACIM,EAAQG,QAAQL,MAAUK,EAA9B,GAAAA,MACQX,QAAQQ,IAAAA,EAAQN,QALXA,UAOTU,EAAJA,SAAIA,wBASVV,OAAQ,SAAAL,EAAMC,GAEpB,IAAMK,EAAeF,EAAJA,KAASE,SADpBQ,EAAQd,EAAII,KAAKU,MAGnBP,EACAP,EAAAI,KAAAE,SAIIN,IAAIW,MACAA,4DACAA,CAAAA,EAAQG,EAAQA,GACpBZ,SAAAA,EAAAO,GAOC,GANED,QAAOL,IAAMK,EAANQ,UACND,EAAJJ,QAAAC,OAAAH,EAAAO,SAVRhB,EAAAW,QAAAN,SAAAA,EANJL,EAAAW,QAAAG,MAAAA,EAcYZ,QAAQC,IAAI,gBAAgBM,EAAOO,UAO/BR,EAAA,MAAVS,EACMd,EAAIH,SAAJG,uBAMJY,QAAS,SAAAf,EAAAC,GAPjBC,QAAAC,IAAAH,EAAAW,QAAAC,QAEIZ,EAAIW,QAAQO,QAAQ,SAACC,GAQlBC,GAAAA,EAAP,MAAiBD,IAAeF,QAAAA,IAAAA,WAAhChB,EAAAc,SAAA,aAAAM,OAAOD,QAAU,CAACrB,OAAAA,OAAOuB,OAAAA,OAAOL,QAAAA","file":"usertask.min.js","sourcesContent":["const con = require('../db/dbconnect')\n\n//ログイン\nconst SignIn = (req,res) =>{\n    console.log(req.body)\n    const username = req.body.username;\n    const password = req.body.password;\n    con.query(\n        'SELECT * FROM USERS WHERE username=? AND password=?;'\n        ,[username,password],\n        (error,result)=>{\n            if(error) throw error;\n            console.log(result[0])\n            if(result.length){\n                req.session.userid= result[0].id;\n                console.log('ログイン成功ユーザーID： '+req.session.userid);\n                req.session.username = result[[0]].username;\n                req.session.email = result[0].email;\n                console.log(req.session.username)\n                // res.render('userpage.ejs',{username: result[0].username});\n                res.redirect(`/api/v1/userpage`);\n            }\n        }\n    )\n}\n\n//会員登録\nconst SignUp = (req,res) =>{\n    \n    const username = req.body.username;\n    const email = req.body.email;\n    const password = req.body.password;\n    // console.log(username,email,password)\n    con.query(\n        'INSERT INTO USERS (username,email,password) value(?,?,?);'\n        ,[username,email,password],\n        (error,result)=>{\n            console.log(result.insertId)\n            req.session.userid = result.insertId;\n            req.session.username = username\n            req.session.email = email;\n            console.log('会員登録されたユーザID：'+result.insertId)\n            if(error) throw error;\n            res.redirect(`/api/v1/userpage`)\n        }\n    )\n}\n\nconst SignOut = (req,res)=>{\n    console.log(req.session.userid)\n    req.session.destroy((err)=>{\n        if(err) throw err\n    });\n    \n    console.log('ログアウト完了')\n    res.redirect('/api/v1/');\n}\n\nmodule.exports = {SignIn,SignUp,SignOut}"]}