"use strict";var con=require("../db/dbconnect"),express=require("express"),session=require("express-session"),app=express(),router=express.Router();router.get("/toppage",function(e,s){s.render("index.ejs")}),router.get("/api1/signin",function(e,s){s.render("signin.ejs")}),router.get("/api1/signup",function(e,s){s.render("signup.ejs")}),router.post("/api2/signin",function(o,r){console.log(o.body);var e=o.body.username,s=o.body.password;con.query("SELECT * FROM USERS WHERE username=? AND password=?;",[e,s],function(e,s){if(e)throw e;console.log(s[0]),s.length&&(o.session.userid=s[0].id,console.log("ログイン成功ユーザーID： "+o.session.userid),o.session.username=s[[0]].username,o.session.email=s[0].email,console.log(o.session.username),r.redirect("/userpage"))})}),router.get("/userpage/",function(e,s){s.render("userpage")}),router.post("/api2/signup",function(o,r){var n=o.body.username,i=o.body.email,e=o.body.password;con.query("INSERT INTO USERS (username,email,password) value(?,?,?);",[n,i,e],function(e,s){if(console.log(s.insertId),o.session.userid=s.insertId,o.session.username=n,o.session.email=i,console.log("会員登録されたユーザID："+s.insertId),e)throw e;r.redirect("/userpage")})}),router.post("/logout",function(e,s){console.log(e.session.userid),e.session.destroy(function(e){if(e)throw e}),console.log("ログアウト完了"),s.redirect("/toppage")}),module.exports=router;
//# sourceMappingURL=users.min.js.map
